<template name="findWrap">
	<div class="find">
		<h1>{{mf 'find.WhatLearn?' 'What do you want to learn?'}}</h1>
		{{> find}}
	</div>
</template>

<template name="find">
	<div class="search">
		<div class="-searchField">
			<div class="input-group">
				<input
					type="text"
					id="find"
					class="-searchInput"
					value="{{search}}"
					placeholder="{{mf 'find.search_placeholder' 'Everything'}}"
				/>
				<span class="input-group-btn">
					<button class="-findButton" type="button">
						{{mf 'find.search_go' 'Go!'}}
					</button>
				</span>
				{{#unless isMobile}}
					<span class="input-group-btn">
						{{#if showingFilters}}
							<button class="-showFilters remove-filter" type="button">
								<span class="glyphicon glyphicon-filter"></span>
								{{mf 'find.hideFilters' 'Remove filters'}}
							</button>
						{{else}}
							<button class="-showFilters" type="button">
								<span class="glyphicon glyphicon-filter"></span>
								{{mf 'find.showFilters' 'Filter'}}
							</button>
						{{/if}}
					</span>
				{{/unless}}
			</div>
		</div>
		{{#if isMobile}}
			{{#if showingFilters}}
				<button class="-showFilters remove-filter" type="button">
					<span class="glyphicon glyphicon-filter"></span>
					{{mf 'find.hideFilters' 'Remove filters'}}
				</button>
			{{else}}
				<button class="-showFilters" type="button">
					<span class="glyphicon glyphicon-filter"></span>
					{{mf 'find.showFilters' 'Filter'}}
				</button>
			{{/if}}
		{{/if}}
		<div class="search_filter" style="{{#if showingFilters}}display:block;{{else}}display:none;{{/if}}">
			<div class="search_filter_header">
				<h4>
					<span class="glyphicon glyphicon-filter"></span>
					{{mf 'find.search_filter.title' 'Filter search'}}
				</h4>
			</div>
			<div class="search_events">
				<div class="checkbox -filterToggle">
					<label>
						<input
							type="checkbox"
							id="hasUpcomingEvent"
							name="hasUpcomingEvent"
							{{toggleChecked 'upcomingEvent'}}
						/>
						{{#if toggleChecked 'upcomingEvent'}}
							<div class="eventcaption_upcoming">
								<div class="eventcaption_upcoming_box">
									<div class="eventcaption_upcoming_text first-line"></div>
									<div class="eventcaption_upcoming_text second-line"></div>
									<div class="eventcaption_upcoming_text third-line"></div>
								</div>
							</div>
						{{/if}}
						{{#unless toggleChecked 'upcomingEvent'}}
							<span class="glyphicon glyphicon-calendar"></span>
						{{/unless}}
						&nbsp;
						{{mf 'find.with_upcoming_events' 'With upcoming events'}}
						&nbsp;
						{{#if toggleChecked 'upcomingEvent'}}
							<span class="glyphicon glyphicon-ok"></span>
						{{/if}}
					</label>
				</div>
				<div class="checkbox -filterToggle">
					<label>
						<input
							type="checkbox"
							id="needsHost"
							name="needsHost"
							style="display: none"
							{{toggleChecked 'needsHost'}}
						/>
						<span class="glyphicon glyphicon-home {{#if toggleChecked 'needsHost'}} checked{{/if}}"></span>
						&nbsp;
						{{mf 'find.needsHost' 'Looking for a host'}}
						&nbsp;
						{{#if toggleChecked 'needsHost'}}
							<span class="glyphicon glyphicon-ok"></span>
						{{/if}}
					</label>
				</div>
				<div class="checkbox -filterToggle">
					<label>
						<input
							type="checkbox"
							id="needsMentor"
							name="needsMentor"
							style="display: none"
							{{toggleChecked 'needsMentor'}}
						/>
						<span class="fa fa-graduation-cap{{#if toggleChecked 'needsMentor'}} checked{{/if}}"></span>
						&nbsp;
						{{mf 'find.needsMentor' 'Looking for a mentor'}}
						&nbsp;
						{{#if toggleChecked 'needsMentor'}}
							<span class="glyphicon glyphicon-ok"></span>
						{{/if}}
					</label>
				</div>
			</div>
			<div class="filter_categories">
				<h4>{{mf 'find.filter.categories' 'Categories'}}</h4>
				{{#if categories}}
					<ul class="selected_categories">
					{{#each categories}}
						<li>
							<span class="category">{{categoryName}}</span>
							<span
								class="glyphicon glyphicon-remove -removeCategoryFilter"
								title="{{mf 'find.filter.removeCategory' 'Remove category {CATEGORYNAME} from filter' CATEGORYNAME=categoryName}}">
							</span>
						</li>
					{{/each}}
					</ul>
				{{/if}}
				<div class="dropdown -categorySelect categorySelect">
					<input
						class="-searchCategories"
						placeholder="{{mf 'find.searchCategories.placeholder' 'Add category'}}"
					/>
					<span
						class="dropdown-toggle"
						data-toggle="dropdown"
						role="button"
						aria-expanded="false">
					</span>
					<ul class="dropdown-menu" role="menu">
						{{#if availableCategories}}
							{{#each availableCategories}}
								<li class="{{this}}">
									<a class="category {{#if availableSubcategories this}}parent{{/if}}">
										{{categoryName}}
									</a>
									{{#if availableSubcategories this}}
										<small
											class="-showSubcategories {{this}}"
											title="{{mf 'find.showSubcategories.title' 'Show/Hide subcategories'}}">
											<span class="glyphicon glyphicon-plus"></span>
										</small>
									{{/if}}
								</li>
								{{#each availableSubcategories this}}
									<li class="-subcategory {{..}}">
										<a class="category">{{categoryName}}</a>
									</li>
								{{/each}}
							{{/each}}
						{{else}}
							<li class="no_categories">
								{{mf 'find.no_categories' 'No categories found.'}}
							</li>
						{{/if}}
					</ul>
				</div>
			</div>
		</div>
	</div>
	<div class="courselist_results">
		{{#unless ready}}
			{{> loadingPage}}
		{{else}}
			{{#each results}}
				{{> course}}
			{{else}}
				<div class="no_courses_found">
				{{mf 'find.no_courses_found' 'No Courses found.'}}
				{{#unless allRegions}}
					<br>
					<button class="-searchAllRegions">
						<span class="fa fa-dot-circle-o"></span>
						{{mf 'find.searchAllRegions' 'Search in all regions'}}
					</button>
					<br>
				{{/unless}}
				{{#if proposeNewBlurb}}
					{{mf 'find.propose_new_course?' 'Why not propose a new one for "{TERM}"?' TERM=this.query.search}}
				{{/if}}
				</div>
			{{/each}}
		{{/unless}}
	</div>
	{{#if eventResults.count}}
		<div class="courselist_results">
			<hr>
			<h3>
			{{#if results.count}}
				{{#mf KEY='find.events.aditional_results' EVENTS=eventResults.count}}
					{EVENTS, plural,
						one {In addition, we found this event}
						other {In addition, we found these # events}
					}
				{{/mf}}
			{{else}}
				{{#mf KEY='find.events.results_if_no_courses' EVENTS=eventResults.count}}
					{EVENTS, plural,
						one {All we found is this one event}
						other {Yet # Events have been found}
					}
				{{/mf}}
			{{/if}}
			</h3><br />
			{{#each eventResults}}
				<!-- <div class="event_results"> -->
					{{> small_event}}
				<!-- </div> -->
			{{/each}}
		</div>
	{{/if}}
	{{> course_edit newCourse}}
</template>
